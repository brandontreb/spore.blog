{
  "name": "Cocos2D Tutorial \u0026#8211; Dynamically Coloring Sprites",  
  "content": "![Custom Bitizens][1]\n\nHave you ever seen a game (such as Tiny Tower) that contains similar sprites that only vary by certain attributes (coloring, shading, accessories, etc\u0026#8230;)? I would often wonder how long it would take the artists to create each permutation of these sprites. After discovering that you can call a method on a CCSprite called setColor, I realized how most of this customization is done in code.\n\nThis tutorial will be a continuation of my last post about [creating your own Bitizen in Photoshop][2]. So, if you don\u0026#8217;t already have a Bitizen character to work with, I suggest you follow that tutorial OR download my template [here][3].\n\n#### White Out\n\nAs I mentioned above, we are going to be using the setColor method of CCSprite to dynamically color each part of our Bitizen. The way it works is each pixel\u0026#8217;s color is multiplied by the value passed into setColor giving it a \u0026#8220;tint\u0026#8221;. So, pixels that are all white will be fully tinted and pixels that are all black will have no change.\n\nSo, our first goal is to create an \u0026#8220;all white\u0026#8221; version of our Bitizen. Don\u0026#8217;t worry about shading for now, I will cover that in a moment. I just started with our Bitizen as a base and created new layers for each of the \u0026#8220;white\u0026#8221; components.\n\nYou should end up with 5 new layers:\n\n  * white-head\n  * white-skin\n  * white-hair\n  * white-pants\n  * white-shoes\n\nFor each layer, trace over the corresponding colored layer. For the \u0026#8220;white-skin\u0026#8221; layer, make sure to trace over the hands as well as the face. This will ensure that your Bitizen\u0026#8217;s color is consistent. When you are done, your Bitizen should look something like this:\n\n![White Bitizen][4]\n\nLooks pretty bland\u0026#8230; The next step is to add our shading. We will be using only black with varying alpha in order to achieve the desired shading. So, make sure to play with it a bit and get the shading to your liking. Add a new shading layer for each component (or simply draw on top of the current layer with the black pencil).\n\nYour bitizen should look something like this after doing all of the shading:\n\n![Shaded Bitzen][5]\n\n#### Chop It Up\n\nThe final thing we need to do with our graphic is chop up the pieces so that they can be individually colored. Convert each of the white-* layers to Smart Objects, copy them to a new document, and save them. You should end up with 5 .png files (head.png,skin.png,hair.png,pants.png,shoes.png).\n\nI increased the size of my Bitizen by 4 before doing this step. You might consider increasing their size as well. Remember that the size increase you choose will change some of the values when we recreate the Bitizen in Cocos2D. So, if you want to follow along, make sure your Bitizen is 60\u0026#215;100 before exporting the various parts.\n\nOne thing to note is we are going to bring these into Cocos2D as 5 different sprites. There are some optimizations that you could do using sprite sheets, however I want to make things as clear as possible. So, we are going the long way.\n\n[You can download my completed white bitizen here][6].\n\n#### Rebuilding The Bitizen In Cocos2D\n\nOnce you have imported the 5 Bitizen image files into Cocos2D, you need to reconstruct them in code. This involves adding each sprite to the layer.\n\nHere is the code to display the skin/head+hands in our layer. As a note, I simply created a new Cocos2D project and am using the retina only mode for my display using [director enableRetinaDisplay:YES]. The offsets will change quite a bit if you are choosing to support non-retina.\n\n\u003cdiv\u003e\n  \u003cpre\u003e\u0026lt;code class=’objc’\u003eint spriteX = 240;\nint spriteY = 160;\n\nCCSprite *skin = [CCSprite spriteWithFile:@\"skin.png\"];\n[skin setPosition:ccp(spriteX, spriteY)];\n[self addChild:skin];\u0026lt;/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\nThis will draw our white(shaded) head on the screen. That\u0026#8217;s pretty boring so let\u0026#8217;s draw the rest of the body. Update your code to look like the following:\n\n\u003cdiv\u003e\n  \u003cpre\u003e\u0026lt;code class=’objc’\u003eint spriteX = 240;\nint spriteY = 160;\n\nCCSprite *skin = [CCSprite spriteWithFile:@\"skin.png\"];\n[skin setPosition:ccp(spriteX, spriteY)];\n[self addChild:skin];\n\nint hairOffset = 11;\n\nCCSprite *hair = [CCSprite spriteWithFile:@\"hair.png\"];\n[hair setPosition:ccp(spriteX, spriteY+hairOffset)];\n[self addChild:hair];\n\nint shirtYOffset = -9;\nint shirtXOffset = 1;\n\nCCSprite *shirt = [CCSprite spriteWithFile:@\"shirt.png\"];\n[shirt setPosition:ccp(spriteX + shirtXOffset, spriteY+shirtYOffset)];\n[self addChild:shirt];\n\nint pantsYOffset = -15;\nint pantsXOffset = 1;\n\nCCSprite *pants = [CCSprite spriteWithFile:@\"pants.png\"];\n[pants setPosition:ccp(spriteX + pantsXOffset, spriteY+pantsYOffset)];\n[self addChild:pants];\n\nint shoesYOffset = -17;\nint shoesXOffset = 1;\n\nCCSprite *shoes = [CCSprite spriteWithFile:@\"shoes.png\"];\n[shoes setPosition:ccp(spriteX + shoesXOffset, spriteY+shoesYOffset)];\n[self addChild:shoes];\u0026lt;/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\nNow, you should see the lonely ghost of a Bitizen standing in the center of your screen.\n\n![Ghost Bitizen][7]\n\nStill boring\u0026#8230; Time to spice him up with some color.\n\n#### Tinting Cocos2D Sprites\n\nAs I mentioned before, tinting Cocos2D sprites is very simple. I would recommend keeping all sprites that you wish to tint a shade of white/gray otherwise some crazy things will happen.\n\nThe setColor method takes an array of integers from 0-255. This array contains 3 numbers (1st for red, 2nd for green, 3rd for blue). For example, we can pass all \u003cfont color=\"red\"\u003eRed\u003c/font\u003e to the setColor method by sending it {255,0,0}.\n\nLet\u0026#8217;s start by tinting our Bitizen\u0026#8217;s shirt a random color. Change the code that displays the shirt to look like this:\n\n\u003cdiv\u003e\n  \u003cpre\u003e\u0026lt;code class=’objc’\u003eCCSprite *shirt = [CCSprite spriteWithFile:@\"shirt.png\"];\n[shirt setPosition:ccp(spriteX + shirtXOffset, spriteY+shirtYOffset)];\nccColor3B shirtColor = {arc4random() % 255,arc4random() % 255,arc4random() % 255};\n[shirt setColor:shirtColor];\n[self addChild:shirt];\u0026lt;/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\nNow, every time you run the application, the Bitizen should have a different shirt color. You can apply this principle to each of your sprites to completely customize your Bitizen.\n\nWhat if you only want to limit certain colors? (you ask). Well, that\u0026#8217;s a great question. I solved this by creating an array of ccColor3Bs. Basically an array of arrays. And then I index into this array and set the color accordingly. Here is an example of setting a random skin color to avoid having blue people (unless maybe you are making Smurfs).\n\n\u003cdiv\u003e\n  \u003cpre\u003e\u0026lt;code class=’objc’\u003eccColor3B skinColors[] = { \n    {247,224,194},\n    {255,232,214},\n    {136,119,82},\n    {245,232,205},\n    {144,110,38}\n};\nCCSprite *skin = [CCSprite spriteWithFile:@\"skin.png\"];\n[skin setPosition:ccp(spriteX, spriteY)];\nccColor3B skinColor = skinColors[arc4random() % 5];\n[skin setColor:skinColor];\n[self addChild:skin];\u0026lt;/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\nI have an array of 5 different arrays and randomly index into it using skinColors[arc4random() % 5]. This will give me a random color within my skin color group.\n\nAfter running this through a loop and adding random colors to some of the other sprites, I ended up creating the image you see at the top of this post.\n\n#### Conclusion\n\nI hope that this tutorial has found you well and I have demystified the magic that is dynamic sprites. You may download the source code for this tutorial (include the code to generate the screenshot above) [here][8].\n\nIf you have any questions or comments, please feel free to leave them in the comments section of this post. Also, make sure you [subscribe to my RSS feed][9] for more great tutorials!\n\nHappy Coding!\n\n\u003cspan style=\"font-family: ‘Lucida Grande’;\"\u003e\u003cstrong\u003e\u003cspan style=\"font-weight: normal;\"\u003e\u003cspan style=\"font-family: arial, verdana, tahoma, sans-serif; font-size: 13px; line-height: 20px;\"\u003e\u003cem\u003e﻿﻿This post is part of \u003ca style=\"text-decoration: none; color: #004199; padding: 0px; margin: 0px;\" href=\"http://idevblogaday.com/\"\u003eiDevBlogADay\u003c/a\u003e, a group of indie iOS development blogs featuring two posts per day. You can keep up with iDevBlogADay through the \u003ca style=\"text-decoration: none; color: #004199; padding: 0px; margin: 0px;\" href=\"http://idevblogaday.com/\"\u003eweb site\u003c/a\u003e, \u003ca style=\"text-decoration: none; color: #004199; padding: 0px; margin: 0px;\" href=\"http://feeds.feedburner.com/idevblogaday\"\u003eRSS feed\u003c/a\u003e, or \u003ca style=\"text-decoration: none; color: #004199; padding: 0px; margin: 0px;\" href=\"http://twitter.com/#search?q=%23idevblogaday\"\u003eTwitter\u003c/a\u003e.\u003c/em\u003e\u003c/span\u003e\u003c/span\u003e\u003c/strong\u003e\u003c/span\u003e\n\n\u003cdiv style=\"\"\u003e\n  \u003ca href=\"http://twitter.com/share\" class=\"twitter-share-button\" data-count=\"horizontal\" data-text=\"Cocos2D Tutorial - Dynamically Coloring Sprites\" data-url=\"http://brandontreb.com/cocos2d-tutorial-dynamically-coloring-sprites\"  data-via=\"brandontreb\" data-related=\"brandontreb:\"\u003eTweet\u003c/a\u003e\n\u003c/div\u003e\n\n [1]: http://f.cl.ly/items/42231G3d1P3d1b3H2Q2g/Screen%20shot%202011-07-30%20at%204.39.28%20PM.png\n [2]: http://brandontreb.com/Pixel-Art-Character-Tutorial-Create-A-Bitizen\n [3]: http://cl.ly/2u3h0g2F2H2b1S280519/bitizen.psd\n [4]: http://f.cl.ly/items/0Z08222Z1v233i1G3H1o/Screen%20shot%202011-07-30%20at%204.52.03%20PM.png\n [5]: http://f.cl.ly/items/3f2P3F1b2Z1y1W0W2V3V/Screen%20shot%202011-07-30%20at%203.47.09%20PM.png\n [6]: http://cl.ly/1I102a1F2L323C1R2Y2h\n [7]: http://f.cl.ly/items/090s2v0F1B3d3k3v3V1R/Screen%20shot%202011-07-30%20at%205.10.34%20PM.png\n [8]: http://cl.ly/3h3R2D1p2w2y2X3t0R32\n [9]: http://feeds.feedburner.com/brandontreb\n",
  "permalink" : "https://brandontreb.ngrok.io/2011/07/30/cocos2d-tutorial-dynamically-coloring-sprites/",
  "date":"2011-07-30T00:00:00Z","draft":false,"iscjklanguage":false,"lastmod":"2011-07-30T00:00:00Z","post_type":"article","publishdate":"2011-07-30T00:00:00Z","slug":"cocos2d-tutorial-dynamically-coloring-sprites","tags":["Articles"],"title":"Cocos2D Tutorial \u0026#8211; Dynamically Coloring Sprites","type":"post"
}