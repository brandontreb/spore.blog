{
  "name": "Beginning Jailbroken iOS Development \u0026#8211; Building And Deployment",  
  "content": "Welcome to the next installment of my jailbroken iOS development series. If you haven\u0026#8217;t already done so, read my previous post to get up to speed.\n\n[Beginning Jailbroken iOS Development \u0026#8211; Getting The Tools][1]\n\nNow that your environment has been set up, it\u0026#8217;s time to start hacking your project, building, and deploying it. This tutorial will be fairly quick and will just demonstrate how to build a .deb file and install it on your device. This will not cover creating a Cydia repository for public access (this is for a later tutorial).\n\n#### Introduction\n\nStart by creating a simple project. Refer to the [previous tutorial][1] to determine how to do this. I will use the example of the #1 iphone/application and will be calling it fooProject.\n\n\u003cdiv\u003e\n  \u003cpre\u003e\u0026lt;code class=â€™bashâ€™\u003e$/opt/theos/bin/nic.pl\nNIC 1.0 - New Instance Creator\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\n  [1.] iphone/application\n  [2.] iphone/library\n  [3.] iphone/preference_bundle\n  [4.] iphone/tool\n  [5.] iphone/tweak\nChoose a Template (required): 1\nProject Name (required): fooProject\nPackage Name [com.yourcompany.fooproject]:    \nAuthor/Maintainer Name [Brandon Trebitowski]: \nInstantiating iphone/application in fooproject/â€¦\nDone.\u0026lt;/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\nThis will create a new directory for our project with the following files.\n\n  1. **control**: Contains information about your application/tweak. This is the info you see when you install something from Cydia (name, author, version, etc\u0026#8230;)\n  2. **[applicationName]Application.mm**: This is essentially your appDelegate file. It creates a window, adds your RootViewController and displays it.\n  3. **main.m** : Same main file that you would use in an iPhone project. Just initializes your [applicationName]Application.mm file on launch.\n  4. **Makefile**: contains the necessary build commands to compile your project. I\u0026#8217;ll go over this in detail in a bit\n  5. **Resources**: This folder contains your info.plist and is also where you can place all of your images\n  6. **RootViewController.h/mm**: A simple view controller\n\n#### The Makefile\n\ntheos provides some great tools that simplify the build process as much as possible. I know some of you might shudder at the sound of a Makefile, but trust me, it\u0026#8217;s very painless.\n\nLet\u0026#8217;s first take a look at the anatomy of the Makefile that was generated.\n\n\u003cdiv\u003e\n  \u003cpre\u003e\u0026lt;code class=â€™bashâ€™\u003einclude theos/makefiles/common.mk\u0026lt;/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\nThis line simply tells theos to include the common make commands in your build script to save you some work.\n\n\u003cdiv\u003e\n  \u003cpre\u003e\u0026lt;code class=â€™bashâ€™\u003eAPPLICATION_NAME = fooProject\u0026lt;/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\nThe name of the application we are building. The Makefile will use this constant to do a number of things under the hood. Don\u0026#8217;t modify this unless your application changes names.\n\n\u003cdiv\u003e\n  \u003cpre\u003e\u0026lt;code class=â€™bashâ€™\u003e[applicationName]_FILES = main.m fooProjectApplication.mm RootViewController.mm\u0026lt;/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\nThis is the meat of the Makefile. It\u0026#8217;s the list of m (or mm in this case) files that need to be compiled. *Note: you do not add your .h files here. So, whenever you add a new .m file to the project, make sure to append it to this list or it won\u0026#8217;t get built.\n\n\u003cdiv\u003e\n  \u003cpre\u003e\u0026lt;code class=â€™bashâ€™\u003e[applicationName]_FRAMEWORKS = UIKit Foundation QuartzCore AudioToolbox CoreGraphics\u0026lt;/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\nThis line is not included by default, but is needed if you want to use ANY frameworks; be them Apple\u0026#8217;s or h4x0red ones.\n\n\u003cdiv\u003e\n  \u003cpre\u003e\u0026lt;code class=â€™bashâ€™\u003einclude $(THEOS_MAKE_PATH)/application.mk\u0026lt;/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\nMore defaults to help theos build your project.\n\n#### Setting up Your Environment\n\nDo you remember in the last tutorial that we had to set an environment variable in order to use theos? Well, we need to set a couple more to build and deploy.\n\nHere are the 3 that you MUST have.\n\n\u003cdiv\u003e\n  \u003cpre\u003e\u0026lt;code class=â€™bashâ€™\u003eexport THEOS=/opt/theos/\nexport SDKVERSION=4.3\nexport THEOS_DEVICE_IP=192.168.1.122\u0026lt;/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\n\u003cimg src=\"/img/post_images/2011/04/sbsettings.png\" style=\"float:right;padding:5px\" /\u003e\n\nThe first line, you should have already done. Otherwise you would not have been able to run the nic tool above. The second defines your current SDK version. This will tell theos where to look for your frameworks and whatnot. (ex If you only have 4.2 installed, set this to 4.2). Finally, the last line, tells theos the ip address of your device.\n\nOnce theos does the package install, it will sftp the package to your device for installation. One thing to note here is your iPhone MUST be on the same network as the computer you are developing on.\n\nIf you don\u0026#8217;t know your device\u0026#8217;s ip address, it\u0026#8217;s in the SBSettings menu. If you don\u0026#8217;t have SBSettings, go download it from Cydia and think about why you would have a jailbroken device without this app installed\u0026#8230;\n\n\u003cdiv style=\"clear:both\"\u003e\n  \u0026nbsp;\n\u003c/div\u003e\n\n#### Building The Project\n\nBuilding is just as easy as running the make command inside of your project\u0026#8217;s root directory.\n\nHere is an example of building my fooProject app using the command:\n\n**make**.\n\n\u003cdiv\u003e\n  \u003cpre\u003e\u0026lt;code class=â€™bashâ€™\u003e$ make\nMaking all for application fooProjectâ€¦\n Compiling main.mâ€¦\n Compiling fooProjectApplication.mmâ€¦\n Compiling RootViewController.mmâ€¦\n Linking application fooProjectâ€¦\n Stripping fooProjectâ€¦\n Signing fooProjectâ€¦\u0026lt;/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\nIf your project contains errors, they will be flushed out here. Also, theos treats warnings as errors (as should you) ðŸ˜‰ . So, if you have any warnings you won\u0026#8217;t be able to build.\n\nWhen you are ready to distribute your application, you must build a .deb package. Luckily, theos does this for us with a simple command:\n\n**make package**.\n\n\u003cdiv\u003e\n  \u003cpre\u003e\u0026lt;code class=â€™bashâ€™\u003emake package\nMaking all for application fooProjectâ€¦\nmake[2]: Nothing to be done for â€˜internal-application-compileâ€™.\nMaking stage for application fooProjectâ€¦\n Copying resource directories into the application wrapperâ€¦\ndpkg-deb: building package â€˜com.yourcompany.fooprojectâ€™ in â€˜/Users/brandontreb/Desktop/fooproject/com.yourcompany.fooproject_0.0.1-1_iphoneos-arm.debâ€™.\u0026lt;/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\nYou should now see a file like *com.yourcompany.fooproject\\_0.0.1-1\\_iphoneos-arm.deb* in your project\u0026#8217;s root directory. One great feature of theos is it handles versioning automatically. So subsequent builds will increment the build number. If you change your version in the info.plist file, it will start the build counter over (2-1, 2-2, etc\u0026#8230;).\n\nAt this point, you *could* sftp this file to your device and run:\n\n\u003cdiv\u003e\n  \u003cpre\u003e\u0026lt;code class=â€™bashâ€™\u003edpkg -i com.yourcompany.fooproject_0.0.1-1_iphoneos-arm.deb\u0026lt;/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\nas root to test the installation. However, that is quite a bit of a pain. Luckily, theos will do all of this for you by simply using the command:\n\n**make package install**\n\n\u003cdiv\u003e\n  \u003cpre\u003e\u0026lt;code class=â€™bashâ€™\u003e$ make package install\nMaking all for application fooProjectâ€¦\nmake[2]: Nothing to be done for `internal-application-compileâ€™.\nMaking stage for application fooProjectâ€¦\n Copying resource directories into the application wrapperâ€¦\ndpkg-deb: building package â€˜com.yourcompany.fooprojectâ€™ in â€˜/Users/brandontreb/Desktop/fooproject/com.yourcompany.fooproject_0.0.1-3_iphoneos-arm.debâ€™.\ninstall.copyFile \"/Users/brandontreb/Desktop/fooproject/com.yourcompany.fooproject_0.0.1-3_iphoneos-arm.deb\" \"com.yourcompany.fooproject_0.0.1-3_iphoneos-arm.deb\"\nroot@192.168.1.122â€™s password: \ncom.yourcompany.fooproject_0.0.1-3_iphoneos-arm.deb                                                                                                                                                                                                                              100% 4434     4.3KB/s   00:00    \ninstall.exec \"dpkg -i com.yourcompany.fooproject_0.0.1-3_iphoneos-arm.deb\"\nroot@192.168.1.122â€™s password: \nSelecting previously deselected package com.yourcompany.fooproject.\n(Reading database â€¦ 2006 files and directories currently installed.)\nUnpacking com.yourcompany.fooproject (from com.yourcompany.fooproject_0.0.1-3_iphoneos-arm.deb) â€¦\nSetting up com.yourcompany.fooproject (0.0.1-3) â€¦\u0026lt;/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\nYou will have to enter your password several times during the process. The default is **alpine**.\n\nAfter this has been run, you will need to restart (or respring) your iPhone. Respringing takes a simple button tap if you have SBSettings installed (have you installed it yet?).\n\n#### Conclusion\n\nYou now have all of the tools needed to start hacking your very first jailbroken iOS application. In the next tutorial, we are going to learn about MobileSubstrate hacks and how to overwrite Apple functionality. I will give a basic example of how to display an alert message every time your device boots up.\n\nUntil next time, happy hacking!\n\n\u003cdiv style=\"\"\u003e\n  \u003ca href=\"http://twitter.com/share\" class=\"twitter-share-button\" data-count=\"horizontal\" data-text=\"Beginning Jailbroken iOS Development - Building And Deployment\" data-url=\"http://brandontreb.com/beginning-jailbroken-ios-development-building-and-deployment\"  data-via=\"brandontreb\" data-related=\"brandontreb:\"\u003eTweet\u003c/a\u003e\n\u003c/div\u003e\n\n [1]: /beginning-jailbroken-ios-development-getting-the-tools/\n",
  "permalink" : "https://brandon_swoop.ngrok.io/2011/04/22/beginning-jailbroken-ios-development-building-and-deployment/",
  "date":"2011-04-22T00:00:00Z","draft":false,"iscjklanguage":false,"lastmod":"2011-04-22T00:00:00Z","post_type":"article","publishdate":"2011-04-22T00:00:00Z","slug":"beginning-jailbroken-ios-development-building-and-deployment","tags":["iPhone"],"title":"Beginning Jailbroken iOS Development \u0026#8211; Building And Deployment","type":"post"
}